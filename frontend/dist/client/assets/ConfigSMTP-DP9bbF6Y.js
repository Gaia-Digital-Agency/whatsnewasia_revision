import{n as p,r as c,j as e}from"./chunk-JZWAC4HX-DGixXWWH.js";import{C as W}from"./ComponentCard-GFTzXSMy.js";import{P as Y}from"./PageBreadCrumb-BUBP8Mwu.js";import{P as z}from"./PageMeta-BNMh5ef8.js";import{I as l}from"./InputField-C5WjQYB1.js";import{L as i}from"./Label-x39NtM-Y.js";import{S as R}from"./Select-BCgLQIBa.js";import{S as U}from"./Switch-DDuCAvBI.js";import{B as V}from"./Button-DrUF433q.js";import{A}from"./Alert-D2pDYxK7.js";import{u as I}from"./useTimedMessage-BeJb-9DW.js";import{c as $}from"./createLucideIcon-CFSuRwGv.js";/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],G=$("download",q),J=async()=>{try{return(await p.get("setting/admin/smtp/providers")).data}catch(t){throw console.error(t),t}},K=async()=>{try{return(await p.get("/setting/admin/smtp?view=1")).data}catch(t){throw console.error(t),t}},Q=async t=>{try{return(await p.post("/setting/admin/smtp",t)).data}catch(o){throw console.error(o),o}},X=async t=>{try{return(await p.get(`setting/admin/smtp/provider/${t}`)).data}catch(o){throw console.error(o),o}};function Z(t,o=4,m=4){return t?o+m>=t.length?"*".repeat(t.length):t.slice(0,o)+"*".repeat(t.length-o-m)+t.slice(-m):""}function he(){const[t,o]=c.useState(""),[m,v]=c.useState([]),[j,u]=c.useState(""),[S,y]=c.useState(0),[P,w]=c.useState(""),[h,C]=c.useState(""),[N,b]=c.useState(""),[M,T]=c.useState(""),[g,x]=c.useState(null),[f,_]=c.useState(null),[L,D]=c.useState(""),[k,E]=c.useState(!1);I(f,_),I(g,x),c.useEffect(()=>{(async()=>{try{const r=await K(),a=r==null?void 0:r.data;if(a){const d=Z(a.password??"");o(a.provider_name??""),u(a.host),y(a.port),w(a.username),C(d),b(a.from_name),T(a.from_email),D(a.secure?"Yes":"No"),E(a.secure)}}catch(r){throw console.error(r),r}})()},[]),c.useEffect(()=>{(async()=>{try{const r=await J(),a=r==null?void 0:r.data;if(a){const d=a.map(n=>({key:n.id,value:n.id,label:n.provider_name}));v(d)}}catch(r){console.error(r),v([])}})()},[]);const B=async s=>{o(String(s));const r=await X(Number(s)),a=r==null?void 0:r.data;u((a==null?void 0:a.host)??"")},F=s=>{D(s?"Yes":"No"),E(s)},H=async s=>{var a,d;s.preventDefault();const r={host:j,port:S,secure:k,username:P,from_name:N,from_email:M,is_active:!0};h&&!h.includes("*")&&(r.password=h),t&&(r.provider_name=Number(t));try{const n=await Q(r);(n==null?void 0:n.status_code)==200&&(_("SMTP Configuration updated successfully"),location.reload())}catch(n){n instanceof Error&&x(n.message),typeof n=="object"&&n!==null&&"response"in n&&x(((d=(a=n.response)==null?void 0:a.data)==null?void 0:d.message)??"Something went wrong")}};return e.jsxs("div",{children:[e.jsx(z,{title:"Whats New Asia Admin Dashboard | SMTP Configuration",description:"This is SMTP Configuration Dashboard page for Whats New Asia Admin Dashboard Template"}),e.jsx("div",{className:"grid grid-cols-1 gap-6 xl:grid-cols-1",children:e.jsxs("div",{className:"space-y-12",children:[e.jsx(Y,{pageTitle:"SMTP Configuration"}),e.jsxs(W,{title:"SMTP Configuration",children:[e.jsx("div",{className:"mb-5",children:g&&e.jsx(A,{variant:"error",title:"Error",message:g})}),e.jsx("div",{className:"mb-5",children:f&&e.jsx(A,{variant:"success",title:"Success",message:f})}),e.jsxs("form",{onSubmit:H,children:[e.jsxs("div",{className:"space-y-3 space-x-6 grid grid-cols-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"SMTP Providers"}),e.jsx(R,{options:m,placeholder:t,onChange:s=>{B(String(s))},className:"dark:bg-dark-900"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Host"}),e.jsx(l,{type:"text",onChange:s=>u(s.target.value),placeholder:j})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Port"}),e.jsx(l,{type:"text",onChange:s=>y(Number(s.target.value)),placeholder:S})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Secure"}),e.jsx(U,{label:L,checked:k,onChange:F})]})]}),e.jsxs("div",{className:"space-y-3 space-x-6 grid grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Username"}),e.jsx(l,{type:"text",onChange:s=>w(s.target.value),placeholder:P})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Password"}),e.jsx(l,{type:"text",onChange:s=>C(s.target.value),placeholder:h}),e.jsx("small",{className:"text-red-500 text-xs",children:"* Leave this field empty to keep your current password."})]}),e.jsxs("div",{children:[e.jsx(i,{children:"From Name"}),e.jsx(l,{type:"text",onChange:s=>b(s.target.value),placeholder:N})]}),e.jsxs("div",{children:[e.jsx(i,{children:"From Email"}),e.jsx(l,{type:"text",onChange:s=>T(s.target.value),placeholder:M})]})]}),e.jsx("div",{className:"space-y-6 space-x-6 flex justify-end",children:e.jsx(V,{startIcon:e.jsx(G,{className:"size-5"}),className:"w-1/8",children:"Save"})})]})]})]})})]})}export{he as default};
