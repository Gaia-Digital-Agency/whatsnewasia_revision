import{h as ne,b as ie,X as ae,r as o,D as oe,a0 as ce,j as e,L}from"./chunk-JZWAC4HX-BaRxOj3G.js";import{a as le}from"./article.service-BgP4NldJ.js";import{A as de}from"./Advertisement-CEA8Jpfg.js";import{I as me}from"./Image-Bf5TVGbM.js";import{g as pe}from"./pagination-DPKfsKWo.js";import{f as W}from"./format-D2eluCP0.js";import{N as ge}from"./Newsletter-wpEToWYi.js";import{u as xe}from"./useArticle-DWTfMO-p.js";import{p as he}from"./Helmet-CU18CeMe.js";import"./index-ILMR5Vqc.js";import"./Button-dgVh7ntR.js";import"./newsletter.service-ZKntKtau.js";import"./NotificationContext-BWqXEdeR.js";const{Helmet:ue}=he,fe="http://localhost:8080",je=({page:r,onClick:t,currentPage:c})=>e.jsx("div",{className:`px-4 py-2 font-medium ${typeof r=="string"?"":"cursor-pointer"} ${c==r?"text-front-red":""}`,onClick:()=>{typeof r=="string"||typeof r=="object"||t(r)},children:r}),we=({page:r,currentPage:t,onClick:c})=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"prev-button cursor-pointer",onClick:()=>{c(t-1)},children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"8",height:"12",viewBox:"0 0 8 12",fill:"none",style:{rotate:"180deg"},children:e.jsx("path",{d:"M0.589844 10.59L5.16984 6L0.589844 1.41L1.99984 0L7.99984 6L1.99984 12L0.589844 10.59Z",fill:"black"})})}),typeof r=="object"&&r.map(g=>e.jsx(je,{page:g,currentPage:t,onClick:c})),e.jsx("div",{className:"next-button cursor-pointer",onClick:()=>{c(t+1)},children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"8",height:"12",viewBox:"0 0 8 12",fill:"none",children:e.jsx("path",{d:"M0.589844 10.59L5.16984 6L0.589844 1.41L1.99984 0L7.99984 6L1.99984 12L0.589844 10.59Z",fill:"black"})})})]}),ye=({article:r,tag:t})=>{console.log(r.updatedAt,r.title,W(r.updatedAt));const{getPermalink:c,getFeaturedImageUrl:g}=xe();return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"image-wrapper mb-5",children:e.jsx(me,{url:g(r),ratio:"100%",link:c(r)})}),r.tags&&e.jsx("div",{className:"tag-wrapper mb-2 text-front-red",children:(t==null?void 0:t.name)??""}),e.jsx("div",{className:"title-wrapper mb-2",children:e.jsx(L,{to:c(r),viewTransition:!0,children:e.jsx("p",{className:"text-front-subtitle font-serif",children:r.title})})}),e.jsx("div",{className:"subtitle-wrapper mb-5",children:e.jsx("p",{className:"text-front-small leading-normal text-front-soft-gray",children:r.sub_title})}),e.jsxs("div",{className:"date-wrapper flex gap-x-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"15",height:"14",viewBox:"0 0 15 14",fill:"none",children:[e.jsx("path",{d:"M1.125 4.14229C1.125 3.17103 1.91236 2.38367 2.88362 2.38367H12.1164C13.0877 2.38367 13.875 3.17103 13.875 4.14229V11.6164C13.875 12.5877 13.0877 13.375 12.1164 13.375H2.88362C1.91236 13.375 1.125 12.5877 1.125 11.6164V4.14229Z",stroke:"#7F7F7F","stroke-width":"0.9","stroke-linecap":"round","stroke-linejoin":"round"}),e.jsx("path",{d:"M3.98267 0.624878V3.70246",stroke:"#7F7F7F","stroke-width":"0.9","stroke-linecap":"round","stroke-linejoin":"round"}),e.jsx("path",{d:"M11.0173 0.624878V3.70246",stroke:"#7F7F7F","stroke-width":"0.9","stroke-linecap":"round","stroke-linejoin":"round"}),e.jsx("path",{d:"M3.76294 5.90027H11.2371",stroke:"#7F7F7F","stroke-width":"0.9","stroke-linecap":"round","stroke-linejoin":"round"})]}),e.jsx("p",{className:"text-front-small text-[#A9A9A9]",children:W(r.updatedAt)})]})]})},Re=({isTrending:r=!1})=>{var D,H,M,U,V;const{actualRoute:t,getLocationRouteUrl:c,clientChange:g}=ne(),{taxonomies:m}=ie(),{initialData:x}=ae(),[_,S]=o.useState((x==null?void 0:x.articles)??[]),[Z,A]=o.useState(),[q,B]=o.useState(),[C,X]=o.useState(((D=x==null?void 0:x.pagination)==null?void 0:D.totalPages)??1),[z,f]=o.useState(!1),[h,$]=o.useState(void 0),[j,R]=o.useState([]),[u,b]=o.useState(),[y,v]=oe(),N=y.get("page"),k=N?parseInt(N):1,F=t.category,T=y.get("subcategory"),G=T?parseInt(T):F==null?void 0:F.id,I=y.get("tag"),E=I?parseInt(I):null,J=o.useRef(null),K=r?{isTrending:!0}:{category:G,tag:E},O={id_country:(H=t.country)==null?void 0:H.id,id_city:(M=t.city)==null?void 0:M.id,id_region:(U=t.region)==null?void 0:U.id,limit:9,page:k,...K};o.useEffect(()=>{var s,n,a,w,i;if((n=(s=t.category)==null?void 0:s.tags)!=null&&n.length)b(t.category.tags);else if((a=t.category)!=null&&a.id_parent){const l=(i=(w=m.categories)==null?void 0:w.find(d=>{var p;return d.id==((p=t.category)==null?void 0:p.id_parent)}))==null?void 0:i.tags;b(l??[])}else b([])},[t]),o.useEffect(()=>{f(!0),window.scrollTo(0,0)},[]),o.useEffect(()=>{z&&window.scrollTo(0,0)},[t,N]),o.useEffect(()=>{var s,n,a,w;if(g)if((async()=>{var l;const i=await le({...O});i!=null&&i.articles?(S(i.articles),X(((l=i.pagination)==null?void 0:l.totalPages)??1)):S([])})(),(async()=>{var i,l,d,p;if(t.category){const P=await ce((i=t==null?void 0:t.category)==null?void 0:i.id,{id_country:(l=t.country)==null?void 0:l.id,id_city:(d=t.city)==null?void 0:d.id,id_region:(p=t.region)==null?void 0:p.id});P?(A(P.sub_title),B(P.description)):(A(t.category.sub_title),B(t.category.description))}})(),(s=t.category)!=null&&s.id_parent){const i=(n=m==null?void 0:m.categories)==null?void 0:n.find(d=>{var p;return d.id==((p=t.category)==null?void 0:p.id_parent)}),l=(a=m.categories)==null?void 0:a.filter(d=>d.id_parent==(i==null?void 0:i.id));$(i),R(l)}else{const i=t.category;$(i),R((w=m==null?void 0:m.categories)==null?void 0:w.filter(l=>{var d;return l.id_parent==((d=t.category)==null?void 0:d.id)}))}},[t,N,g]);const Q=s=>u==null?void 0:u.find(n=>n.id==s),Y=s=>{s>C||s<=0||(f(!0),v(n=>{const a=new URLSearchParams(n);return a.set("page",`${s}`),a}))},ee=s=>{if(`${s}`==y.get("tag")){v("tag"),f(!0);return}if(s==0){v("tag"),f(!0);return}f(!0),v(n=>{const a=new URLSearchParams(n);return a.set("tag",`${s}`),a})},te=()=>{var s;if(!(!(j!=null&&j.length)||!j||r))return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex mb-10 border-b border-b-[#BDBDBD]",children:[!!h&&e.jsx(L,{className:`px-5 py-3 cursor-pointer text-front-small ${((s=t.category)==null?void 0:s.id)==(h==null?void 0:h.id)?"is-active text-front-red":"text-[#4B4B4B]"}`,to:`${c()}/${h.slug_title}`,children:h.title}),j.map(n=>{var a;return e.jsx(e.Fragment,{children:e.jsx(L,{className:`px-5 py-3 cursor-pointer text-front-small ${((a=t.category)==null?void 0:a.id)==n.id?"is-active text-front-red":"text-[#4B4B4B]"}`,to:`${c()}/${n.slug_title}`,children:n.title})})})]})})},se=()=>{if(!r)return e.jsx(e.Fragment,{children:e.jsx("div",{className:"outer overflow-x-auto mb-10",children:e.jsx("div",{className:"grid grid-cols-8 gap-x-8 gap-y-10 justify-center pb-10 w-max md:w-full",children:u==null?void 0:u.map(s=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:`item tag-wrapper tag-selector cursor-pointer ${s.id==E?"active":""}`,onClick:(()=>{ee(s.id)}),children:[e.jsx("div",{className:"image-wrapper mb-5 text-center",children:e.jsx("img",{src:`${fe}/${s.icon}`,className:"w-[70px] h-[70px] mx-auto rounded-full bg-[#D9D9D9]",alt:""})}),e.jsx("div",{className:"text-wrapper text-center",children:e.jsx("p",{className:"text-front-small",children:s.name})})]})}))})})})},re=()=>_.length?_.map(s=>{var a;let n;return(a=s==null?void 0:s.tags)!=null&&a.length?n=s.tags[0]:n=void 0,e.jsx(e.Fragment,{children:e.jsx("div",{className:"md:col-span-4 col-span-12",children:e.jsx(ye,{article:s,tag:Q(n)??void 0})})})}):e.jsx("div",{className:"col-span-12",children:"No article for this category"});return e.jsxs(e.Fragment,{children:[e.jsxs(ue,{children:[e.jsxs("title",{children:[r?"Trending":"",((V=t.category)==null?void 0:V.title)??""," - Whatsnew Asia"]}),e.jsx("meta",{name:"description",content:"Whats's New Asia is the ultimate city guide for expats and travelers, featuring the best dining, events, schools, wellness, and travel in Asia"})]}),e.jsxs("section",{className:"py-12",children:[e.jsxs("div",{className:"container",children:[e.jsx("div",{className:"ads-wrapper mb-12",children:e.jsx(de,{})}),e.jsx("div",{className:"grid grid-cols-12 mb-12",children:e.jsxs("div",{className:"md:col-span-10 md:col-start-2 col-span-12",children:[e.jsx("div",{className:"title-wrapper text-center mb-4",children:e.jsx("p",{className:"font-serif text-front-hero",children:Z})}),e.jsx("div",{className:"description-wrapper text-center",children:e.jsx("p",{className:"",children:q})})]})}),te(),se(),e.jsx("div",{className:"grid grid-cols-12 gap-5",ref:J,children:re()}),e.jsx("div",{className:"pagination-wrapper flex justify-center gap-x-4 py-8 items-center",children:e.jsx(we,{page:pe(k,C),currentPage:k,onClick:Y})})]}),e.jsx("div",{className:"newsletter-wrapper bg-front-section-grey py-8 mt-6",children:e.jsx(ge,{})})]})]})};export{Re as default};
