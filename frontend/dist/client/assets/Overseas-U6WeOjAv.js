import{h as V,b as Z,X as _,r as a,D as G,j as e,Z as O,L as W}from"./chunk-JZWAC4HX-DGixXWWH.js";import{b as X}from"./article.service-Cf6EYyU8.js";import{A as Y}from"./Advertisement-Cq0Qawx2.js";import{I as q}from"./Image-B38Khij9.js";import{g as z}from"./pagination-DPKfsKWo.js";import{f as D}from"./format-D2eluCP0.js";import{N as J}from"./Newsletter-BWtPjMOU.js";import{u as K}from"./useArticle-CHSnUTrj.js";import"./index-BkoRSW3W.js";import"./Button-CjL-dzwU.js";import"./newsletter.service-BGFLEjjE.js";import"./NotificationContext-Bm_P1CXC.js";const Q=({page:t,onClick:s,currentPage:i})=>e.jsx("div",{className:`px-4 py-2 font-medium ${typeof t=="string"?"":"cursor-pointer"} ${i==t?"text-front-red":""}`,onClick:()=>{typeof t=="string"||typeof t=="object"||s(t)},children:t}),ee=({page:t,currentPage:s,onClick:i})=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"prev-button cursor-pointer",onClick:()=>{i(s-1)},children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"8",height:"12",viewBox:"0 0 8 12",fill:"none",style:{rotate:"180deg"},children:e.jsx("path",{d:"M0.589844 10.59L5.16984 6L0.589844 1.41L1.99984 0L7.99984 6L1.99984 12L0.589844 10.59Z",fill:"black"})})}),typeof t=="object"&&t.map(o=>e.jsx(Q,{page:o,currentPage:s,onClick:i})),e.jsx("div",{className:"next-button cursor-pointer",onClick:()=>{i(s+1)},children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"8",height:"12",viewBox:"0 0 8 12",fill:"none",children:e.jsx("path",{d:"M0.589844 10.59L5.16984 6L0.589844 1.41L1.99984 0L7.99984 6L1.99984 12L0.589844 10.59Z",fill:"black"})})})]}),se=({article:t,tag:s})=>{const{getPermalink:i,getFeaturedImageUrl:o}=K();return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"image-wrapper mb-5",children:e.jsx(q,{url:o(t),ratio:"100%",link:i(t)})}),t.tags&&e.jsx("div",{className:"tag-wrapper mb-2 text-front-red",children:(s==null?void 0:s.name)??""}),e.jsx("div",{className:"title-wrapper mb-5",children:e.jsx(W,{to:i(t),viewTransition:!0,children:e.jsx("p",{className:"text-front-subtitle font-serif",children:t.title})})}),e.jsxs("div",{className:"date-wrapper flex gap-x-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"15",height:"14",viewBox:"0 0 15 14",fill:"none",children:[e.jsx("path",{d:"M1.125 4.14229C1.125 3.17103 1.91236 2.38367 2.88362 2.38367H12.1164C13.0877 2.38367 13.875 3.17103 13.875 4.14229V11.6164C13.875 12.5877 13.0877 13.375 12.1164 13.375H2.88362C1.91236 13.375 1.125 12.5877 1.125 11.6164V4.14229Z",stroke:"#7F7F7F","stroke-width":"0.9","stroke-linecap":"round","stroke-linejoin":"round"}),e.jsx("path",{d:"M3.98267 0.624878V3.70246",stroke:"#7F7F7F","stroke-width":"0.9","stroke-linecap":"round","stroke-linejoin":"round"}),e.jsx("path",{d:"M11.0173 0.624878V3.70246",stroke:"#7F7F7F","stroke-width":"0.9","stroke-linecap":"round","stroke-linejoin":"round"}),e.jsx("path",{d:"M3.76294 5.90027H11.2371",stroke:"#7F7F7F","stroke-width":"0.9","stroke-linecap":"round","stroke-linejoin":"round"})]}),e.jsx("p",{className:"text-front-small text-[#A9A9A9]",children:D(t.updatedAt)})]})]})},xe=({isTrending:t=!1})=>{var N,k;const{actualRoute:s}=V(),{taxonomies:i}=Z(),{initialData:o}=_(),[g,f]=a.useState((o==null?void 0:o.articles)??[]),[A,S]=a.useState(),[T,C]=a.useState(),[j,R]=a.useState(((N=o==null?void 0:o.pagination)==null?void 0:N.totalPages)??1),[h,w]=a.useState(!1),[x,v]=a.useState(),E=["experience","ultimate-guide","featured"],[I,M]=G(),m=I.get("page"),u=m?parseInt(m):1,$=a.useRef(null);a.useEffect(()=>{var r,n;(n=(r=s.category)==null?void 0:r.tags)!=null&&n.length?v(s.category.tags):v([])},[s]),a.useEffect(()=>{w(!0),window.scrollTo(0,0)},[]),a.useEffect(()=>{h&&window.scrollTo(0,0)},[s,m]),a.useEffect(()=>{var c,y;if(!h)return;(async()=>{var b,F,L;const d=new URLSearchParams;(b=i.countries)==null||b.filter(l=>{var P;return l.id!=((P=s.country)==null?void 0:P.id)}).forEach(l=>{d.append("id_country[]",`${l.id}`)}),(F=i.categories)==null||F.filter(l=>E.includes(l.slug_title)).forEach(l=>{d.append("category[]",`${l.id}`)}),d.append("page",`${u}`),d.append("limit","9");const p=await X({},d);p!=null&&p.articles?(f(p.articles),R(((L=p.pagination)==null?void 0:L.totalPages)??1)):f([])})();const r=(c=s.category)==null?void 0:c.sub_title,n=(y=s.category)==null?void 0:y.description;S(r),C(n)},[s,m,h]);const B=r=>x==null?void 0:x.find(n=>n.id==r),H=r=>{r>j||r<=0||(w(!0),M(n=>{const c=new URLSearchParams(n);return c.set("page",`${r}`),c}))},U=()=>g.length?g.map(r=>{var c;let n;return(c=r==null?void 0:r.tags)!=null&&c.length?n=r.tags[0]:n=void 0,e.jsx(e.Fragment,{children:e.jsx("div",{className:"md:col-span-4 col-span-12",children:e.jsx(se,{article:r,tag:B(n)??void 0})})})}):e.jsx("div",{className:"col-span-12",children:"No article for this category"});return e.jsxs(e.Fragment,{children:[e.jsxs(O,{children:[e.jsxs("title",{children:[t?"Trending":"",((k=s.category)==null?void 0:k.title)??""," - Whatsnew Asia"]}),e.jsx("meta",{name:"description",content:"Whats's New Asia is the ultimate city guide for expats and travelers, featuring the best dining, events, schools, wellness, and travel in Asia"})]}),e.jsxs("section",{className:"py-12",children:[e.jsxs("div",{className:"container",children:[e.jsx("div",{className:"ads-wrapper mb-12",children:e.jsx(Y,{})}),e.jsx("div",{className:"grid grid-cols-12 mb-12",children:e.jsxs("div",{className:"md:col-span-10 md:col-start-2 col-span-12",children:[e.jsx("div",{className:"title-wrapper text-center mb-4",children:e.jsx("p",{className:"font-serif text-front-hero",children:A})}),e.jsx("div",{className:"description-wrapper text-center",children:e.jsx("p",{className:"",children:T})})]})}),e.jsx("div",{className:"grid grid-cols-12 gap-5",ref:$,children:U()}),e.jsx("div",{className:"pagination-wrapper flex justify-center gap-x-4 py-8 items-center",children:e.jsx(ee,{page:z(u,j),currentPage:u,onClick:H})})]}),e.jsx("div",{className:"newsletter-wrapper bg-front-section-grey py-8 mt-6",children:e.jsx(J,{})})]})]})};export{xe as default};
